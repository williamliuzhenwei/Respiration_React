{"ast":null,"code":"var _jsxFileName = \"/Users/liuzhenwei/Developer/Respiration_React/Frontend/src/Component/Plot.js\";\nimport React from 'react';\nimport { Button } from 'antd';\nimport { Line } from '@ant-design/charts';\nimport { ContinuousLegend } from '@antv/g2/lib/dependents';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar data = [];\nvar timer1 = 0;\nvar entry = {};\nvar res = {};\nvar counter = 10; // To update the graph every 10 seconds\n// Main Plot configuration\n\nconst config = {\n  data,\n  xField: 'TimeStamp',\n  yField: 'Rate',\n  label: {\n    style: {\n      fill: '#aaa'\n    }\n  },\n  point: {\n    size: 1,\n    shape: 'dot'\n  }\n}; // Communicate with particle Photon\n\nconst fetchData = () => {\n  // David  https://api.particle.io/v1/devices/440048000d51353532343635/output1?access_token=5337556d927166dd61f24a448628ab25b487250d\n  // Siyuan https://api.particle.io/v1/devices/2d004e000d51353532343635/analogvalue?access_token=4ec91795c48fcb469901a8c61e670f4d75ec5cce\n  return fetch(\"https://api.particle.io/v1/devices/440048000d51353532343635/respiration?access_token=5337556d927166dd61f24a448628ab25b487250d\").then(response => response.json()).then(data => res = data).then(console.log(res));\n}; // Main Module \n\n\nclass Plot extends React.Component {\n  constructor() {\n    super();\n\n    this.handleClick = () => {\n      this.setState(state => ({\n        isToggleOn: !state.isToggleOn\n      }));\n    };\n\n    this.refresh = () => {\n      window.location.reload(false);\n    };\n\n    this.render = () => {\n      if (this.state.isToggleOn == true) {\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            id: \"toggle\",\n            style: {\n              textAlign: 'center'\n            },\n            type: \"primary\",\n            onClick: this.handleClick,\n            children: this.state.isToggleOn ? 'ON' : 'OFF'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 11\n          }, this), \"\\xA0\\xA0\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n            id: \"refresh\",\n            style: {\n              textAlign: 'center'\n            },\n            type: \"primart\",\n            onClick: this.refresh,\n            children: \"Refresh\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Line, { ...config\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true);\n      } else if (this.state.isToggleOn == false) {\n        document.getElementById(\"resRate\").innerHTML = \"Disconnected\"; // data = [];\n\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            id: \"toggle\",\n            style: {\n              textAlign: 'center'\n            },\n            type: \"secondary\",\n            onClick: this.handleClick,\n            children: this.state.isToggleOn ? 'ON' : 'OFF'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Line, { ...config\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true);\n      }\n    };\n\n    this.state = {\n      date: new Date(),\n      isToggleOn: true\n    };\n  }\n\n  componentDidMount() {\n    this.timerID = setInterval(() => this.tick(), // time interval in millis;\n    999);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.timerID);\n  }\n\n  tick() {\n    fetchData(); // let resR = Math.floor(Math.random() * (17 - 8) + 8);\n\n    let resR = res.result;\n    console.log(counter);\n\n    if (this.state.isToggleOn == true) {\n      if (res.ok == false) {\n        // Connected, but not reading\n        document.getElementById(\"resRate\").innerHTML = \"Photon error || \" + res.error;\n        document.getElementById(\"resRate\").className = \"resRate_red\";\n        counter = 10;\n      } else if (resR == 0) {\n        // Connected, Measring \n        document.getElementById(\"resRate\").innerHTML = \"Measuring\";\n        document.getElementById(\"resRate\").className = \"resRate_green\";\n        counter = 10;\n      } else if (resR < 6 || resR > 60) {\n        // Bad result \n        console.log(resR);\n        document.getElementById(\"resRate\").innerHTML = \"Check Epidermal Device (Strain Gauge)\"; // Please check adhesive (maybe loose)\n\n        document.getElementById(\"resRate\").className = \"resRate_red\";\n        counter = 10;\n      } else if (res.error == \"Timed out.\") {\n        document.getElementById(\"resRate\").innerHTML = \"Cannot connect to Photon\";\n        document.getElementById(\"resRate\").className = \"resRate_red\";\n        counter = 10;\n      } else if (resR >= 6 && resR <= 60) {\n        // In normal range\n        if (counter == 10) {\n          entry = {\n            TimeStamp: timer1,\n            Rate: Math.round(resR)\n          };\n          timer1 = timer1 + 1;\n          data.push(entry);\n          document.getElementById(\"resRate\").innerHTML = Math.round(resR);\n          document.getElementById(\"resRate\").className = \"resRate_black\";\n          counter = 0;\n        }\n\n        counter++;\n      } else {\n        document.getElementById(\"resRate\").innerHTML = \"Checking Status\";\n        document.getElementById(\"resRate\").className = \"resRate_black\";\n        counter = 10;\n      }\n    } else if (this.state.isToggleOn == false) {\n      entry = {\n        TimeStamp: timer1,\n        Rate: 0\n      };\n      data.push(entry);\n      document.getElementById(\"resRate\").innerHTML = \"Disconnected\";\n      counter = 10;\n    }\n\n    this.setState({\n      date: new Date()\n    });\n  }\n\n}\n\n;\nexport default Plot;","map":{"version":3,"sources":["/Users/liuzhenwei/Developer/Respiration_React/Frontend/src/Component/Plot.js"],"names":["React","Button","Line","ContinuousLegend","data","timer1","entry","res","counter","config","xField","yField","label","style","fill","point","size","shape","fetchData","fetch","then","response","json","console","log","Plot","Component","constructor","handleClick","setState","state","isToggleOn","refresh","window","location","reload","render","textAlign","document","getElementById","innerHTML","date","Date","componentDidMount","timerID","setInterval","tick","componentWillUnmount","clearInterval","resR","result","ok","error","className","TimeStamp","Rate","Math","round","push"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {Button} from 'antd';\nimport { Line } from '@ant-design/charts';\nimport { ContinuousLegend } from '@antv/g2/lib/dependents';\n\n\nvar data = [];\nvar timer1 = 0;\nvar entry = {};\nvar res = {};\nvar counter = 10; // To update the graph every 10 seconds\n\n// Main Plot configuration\nconst config = {\n  data,\n  xField: 'TimeStamp',\n  yField: 'Rate',\n  label: {\n    style: {\n      fill: '#aaa',\n    },\n  },\n  point: {\n    size: 1,\n    shape: 'dot',\n  },\n};\n\n// Communicate with particle Photon\nconst fetchData = () => {\n  // David  https://api.particle.io/v1/devices/440048000d51353532343635/output1?access_token=5337556d927166dd61f24a448628ab25b487250d\n  // Siyuan https://api.particle.io/v1/devices/2d004e000d51353532343635/analogvalue?access_token=4ec91795c48fcb469901a8c61e670f4d75ec5cce\n  return fetch(\"https://api.particle.io/v1/devices/440048000d51353532343635/respiration?access_token=5337556d927166dd61f24a448628ab25b487250d\")\n        .then((response) => response.json())\n        .then((data) => res = data)\n        .then(console.log(res));}\n\n// Main Module \nclass Plot extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n        date: new Date(),\n        isToggleOn: true\n    }\n}\nhandleClick = () => {\n  this.setState(state => ({\n    isToggleOn: !state.isToggleOn\n  }));\n}\n\nrefresh = () =>{\n  window.location.reload(false);\n}\n\ncomponentDidMount() {\n    this.timerID = setInterval(\n        () => this.tick(),\n        // time interval in millis;\n        999\n    );\n}\n\ncomponentWillUnmount() {\n    clearInterval(this.timerID);\n}\n\ntick() {\n  fetchData();\n  // let resR = Math.floor(Math.random() * (17 - 8) + 8);\n  let resR = res.result;\n  console.log(counter);\n  if (this.state.isToggleOn == true){\n    if(res.ok == false){ // Connected, but not reading\n      document.getElementById(\"resRate\").innerHTML = \"Photon error || \" + res.error ;\n      document.getElementById(\"resRate\").className = \"resRate_red\";\n      counter = 10;\n    }  else if (resR == 0){  // Connected, Measring \n      document.getElementById(\"resRate\").innerHTML = \"Measuring\";\n      document.getElementById(\"resRate\").className = \"resRate_green\";\n      counter = 10;\n    } else if (resR < 6 || resR > 60){  // Bad result \n      console.log(resR);\n      document.getElementById(\"resRate\").innerHTML = \"Check Epidermal Device (Strain Gauge)\"; // Please check adhesive (maybe loose)\n      document.getElementById(\"resRate\").className = \"resRate_red\";\n      counter = 10;\n    } else if (res.error == \"Timed out.\" ){ \n      document.getElementById(\"resRate\").innerHTML = \"Cannot connect to Photon\";\n      document.getElementById(\"resRate\").className = \"resRate_red\";\n      counter = 10;\n    } else if (resR >= 6 && resR <= 60){ // In normal range\n        if (counter == 10){\n        entry = {TimeStamp: timer1, Rate: Math.round(resR)};\n        timer1 = timer1 + 1;\n        data.push(entry)\n        document.getElementById(\"resRate\").innerHTML = Math.round(resR);\n        document.getElementById(\"resRate\").className = \"resRate_black\";\n        counter = 0;\n        }\n        counter++;\n    } else {\n      document.getElementById(\"resRate\").innerHTML = \"Checking Status\";\n      document.getElementById(\"resRate\").className = \"resRate_black\";\n      counter = 10;\n    }\n    \n  } else if (this.state.isToggleOn == false) {\n    entry = {TimeStamp: timer1, Rate: 0}\n    data.push(entry)\n    document.getElementById(\"resRate\").innerHTML = \"Disconnected\";\n    counter = 10;\n  }\n    this.setState({\n        date: new Date()\n    })\n}\n      render = () => {\n        if (this.state.isToggleOn == true){\n          return (\n          <>\n          <Button id = \"toggle\" style= {{textAlign:'center'}} type = 'primary' onClick={this.handleClick}>\n                  {this.state.isToggleOn ? 'ON' : 'OFF'}\n          </Button>\n          &nbsp;&nbsp;&nbsp;&nbsp;\n          <Button id = \"refresh\" style= {{textAlign:'center'}} type = 'primart' onClick={this.refresh}>\n                Refresh\n          </Button>\n          <br></br>\n          <Line {...config} />\n          <br></br>\n          </>);\n        } else if (this.state.isToggleOn == false){\n          document.getElementById(\"resRate\").innerHTML = \"Disconnected\";\n          // data = [];\n          return (\n          <>\n          \n          <Button id = \"toggle\" style= {{textAlign:'center'}} type = 'secondary' onClick={this.handleClick}>\n                  {this.state.isToggleOn ? 'ON' : 'OFF'}\n          </Button> \n          <br></br>\n          <Line {...config} />\n          <br></br>\n          \n          </>);\n        }\n        \n      }\n       \n};\n\n\n\nexport default Plot;"]},"metadata":{},"sourceType":"module"}